# 03_advanced_cases/solutions/data_quality_issues.ru.md

## Проверка качества данных и потенциальные проблемы

1. **Пользователи без событий**  
   - Пользователи, которые зарегистрировались, но никогда не совершили событие.  
   - Решение: LEFT JOIN users → events, COUNT NULLs.

2. **События без пользователя**  
   - События с `user_id`, которого нет в таблице users.  
   - Решение: LEFT JOIN events → users и проверка NULL.

3. **Дубликаты**  
   - Повторяющиеся события одного пользователя в одну неделю могут искажать retention.  
   - Решение: использовать DISTINCT по `(user_id, cohort_week, activity_week)`.

4. **Day 0**  
   - События в день регистрации могут завышать retention.  
   - Решение: фильтровать `event_time > signup_date`.

5. **Разные часовые пояса и формат даты**  
   - События могут приходить с разными таймзонами → некорректная агрегация по неделям.  
   - Решение: привести все даты к одной зоне.

6. **Отсутствие индексов**  
   - Таблицы MergeTree/ClickHouse или Postgres без индексов → медленные расчёты.  
   - Решение: индексировать `user_id`, `event_time`, `signup_date`.

7. **Отслеживание "активных" пользователей**  
   - Считаем retention только для пользователей с >1 события, чтобы убрать “шум” от разовых визитов.
